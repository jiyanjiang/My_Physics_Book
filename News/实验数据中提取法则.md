### 从实验数据中提炼自由形式的自然法则

**Michael Schmidt¹ and Hod Lipson²,³***

**摘要**
几个世纪以来，科学家们一直试图识别并记录自然界中物理现象背后的分析定律。尽管计算能力已相当普遍，但寻找自然法则及其对应方程的过程却难以实现自动化。自动寻找分析关系的一个关键挑战是，如何通过算法来定义观测数据中的何种关联是重要且富有洞察力的。我们提出了一种识别非平凡性（nontriviality）的原则。我们通过自动搜索从各种物理系统（从简谐振子到混沌双摆）捕获的运动跟踪数据，验证了这一方法。在没有任何关于物理、运动学或几何学的先验知识的情况下，该算法发现了哈密顿量、拉格朗日量以及其他几何和动量守恒定律。随着为更简单系统找到的定律被用于引导对更复杂系统的解释，发现速率得以加速，从而逐步揭示了用于描述这些系统的“字母表”。

---

数学上的对称性和不变量是自然界中几乎所有物理定律的基础（1），这表明寻找许多自然法则的过程，与寻找守恒量和不变方程的过程密不可分（2, 3）。用于从科学测量中生成、收集和存储数据的自动化技术已经变得越来越精确和强大，但将这些数据提炼成分析性自然法则形式的知识的自动化过程却未能跟上步伐。因此，对改进科学数据挖掘形式存在着迫切的实际需求（4, 5, 6, 7）。

为了在计算上搜索守恒律，需要克服的最具挑战性的障碍是找到有意义且非平凡的不变量。存在着无数个在数值上不变但与系统的自然物理或动力学毫无关联的恒等式。我们引入了一个原则，用于仅识别那些与系统动力学相关的有用分析关系。然后，我们展示了一个基于此原则的搜索算法，如何从各种物理系统捕获的数据中识别出有意义的分析联系（图1）。

我们的目标是找到自然存在的、对其分析形式限制最小（即自由形式）的关系。现存许多用于建模科学数据的方法：一些使用源于专家知识的固定形式参数模型，另一些则使用旨在预测的数值模型（如神经网络）。还有一些方法利用贪婪单项式搜索（greedy monomial search）探索了受限的模型空间（8, 9）。与此不同，我们寻求的是主要的、无约束的分析表达式，它能以符号形式解释精确的守恒关系，从而帮助将数据提炼为科学知识。

符号回归（Symbolic regression）（10）是一种基于演化计算（11）的成熟方法，用于在最小化各种误差度量的同时搜索数学表达式空间（参见在线支持材料SOM的S4节）。与传统的线性和非线性回归方法将参数拟合到给定形式的方程不同，符号回归能同时搜索参数和方程的形式（参见SOM的S6节）。初始表达式是通过随机组合数学构建模块（如代数运算符{+, -, ÷, ×}、分析函数（如正弦和余弦）、常数和状态变量）形成的。新方程通过重组先前的方程并概率性地改变其子表达式来形成。算法会保留那些能更好地模拟实验数据的方程，并放弃没有前景的解。当方程达到期望的精度水平后，算法终止，返回一组最有可能对应于观测系统内在机制的方程。

尽管符号回归通常用于寻找显式方程（12-14）和微分方程（15），但这种方法不能轻易地找到守恒律或不变方程。我们并非试图对特定信号建模，而是试图检测系统所遵循的任何潜在物理定律，而这一定律可能并非恒定（例如拉格朗日量）。

一个特殊的挑战是，要求该定律是系统状态的函数，同时要避免平凡或无意义的关系。对于状态空间 **x** 上的任何系统，存在无数个满足守恒量的平凡方程，例如 `sin²(x₁) + cos²(x₁) = 1` 或 `x₁ + 4.56 - x₁`。此外，还存在无数个任意接近的平凡守恒关系，例如 `4.56 + 1/(100 + x₁²)`。为了将好的守恒律候选者与差的区分开来，我们需要一个比单纯的不变性（invariance）更稳健的原则。

识别非平凡关系是一个重大挑战，即使对人类科学家也是如此：许多已发表的不变量最终被证明是巧合（16）。仅仅出现一个守恒值，不足以构成守恒定律。

**图1. 挖掘物理系统。** 我们使用运动跟踪（B）捕获了混沌双摆（A）随时间变化的角和角速度，然后自动搜索描述这些变量之间单一自然法则的方程。在没有任何关于物理或几何的先验知识的情况下，算法找到了守恒律（C），该定律实际上是双摆的哈密顿量。图中展示了实际的摆、数据和结果。

---

在计算上识别非平凡守恒律的关键洞见在于，候选方程应当能预测系统子组件动力学之间的联系。更精确地说，守恒方程应该能够预测一组变量随时间导数之间的联系，而这些关系我们也可以从新的实验数据中轻易计算出来。

这种度量的一个实例是变量对之间的偏导数（参见SOM的S1节）。例如，在一个二维系统中，我们可以测量变量 `x(t)` 和 `y(t)` 随时间的变化。从时间序列数据中估算的系统偏导数将是 `x'/y' ≈ Δx/Δy` 和 `y'/x' ≈ Δy/Δx`（其中 `x'` 和 `y'` 代表 `x` 和 `y` 的时间导数）。同样，给定一个候选守恒律方程 `f(x, y)`，我们可以通过微分得到相同的值：`(∂f/∂y)/(∂f/∂x) ≈ ∂x/∂y`。现在，我们可以比较来自实验数据的 `Δx/Δy` 值与来自候选守恒表达式 `f(x, y)` 的 `∂x/∂y` 值，以衡量它对系统内在关系的预测能力。在更高维的系统中，多个变量配对和高阶导数可以产生大量的判据来使用。

偏导数对度量的一个重要结果是，它还能识别代表系统其他非平凡恒等式的关系，而不仅限于不变量和守恒律。例如，如果系统被约束在一个流形（manifold）上，流形方程也能推导出准确的偏导数对。同样，偏导数对可以识别拉格朗日方程这类方程，它们等效于经典力学中的运动方程，总结了系统动力学但本身并非不变量。

通过选择提供给算法的变量，可以在一定程度上控制系统可能找到的定律类型。例如，如果我们只提供位置坐标，算法将被迫收敛到系统状态空间的流形方程上。如果我们提供速度，算法则偏向于寻找能量定律。如果我们还提供加速度，算法则偏向于寻找力恒等式和运动方程。然而，给定这些或其他类型的变量，也可能存在其他或以前未知的分析定律。

我们使用一种算法（图2），在从多个合成和物理系统捕获的数据中，利用不同组的系统变量来搜索分析定律。我们展示了多个物理实验系统的结果（参见SOM的S7节，了解关于合成系统、几何对称性和流形的研究）。

我们从本科物理教育中常用的标准实验系统收集数据：一个气轨振子和一个双摆（图3）。我们使用运动跟踪软件记录设备随时间的位置。然后，我们数值计算了速度和加速度（参见SOM的S11节）。

在没有任何额外信息、系统模型或理论知识的情况下，采用偏导数对判据的搜索直接从这些数据中产生了多个分析定律表达式。对于每个系统，算法会输出一个简短的列表，包含约10个在不同大小（复杂度）下发现的具有最高准确度的方程（参见SOM的S8节）。然后我们手动检查这个列表以选择最终的方程。通常，这个列表包含了对某一特定定律方程的不同近似或细化，但也可能包含性质上完全不同的方程，如下文所述。

**图2. 从实验数据中检测守恒律的计算方法。** (A) 首先，从数据中计算变量间的偏导数，然后搜索可能描述物理不变量的方程。为了衡量一个方程描述不变量的好坏，以符号方式推导相同的偏导数并与数据进行比较。(B) 符号方程在计算机内存中的表示是一系列连续的数学运算。(C) 这种列表表示对应于一个图形，其中节点代表数学构建模块，叶节点代表参数和系统变量。B和C都对应于同一个方程。算法通过改变这些结构来搜索方程空间。

---

我们实验了两种配置的气轨：(i) 两弹簧单体和 (ii) 三弹簧双体。同样，我们从一个单摆和一个双摆（图3）中收集了时间序列数据。单体气轨是一个谐振子，受到空气和两个弹簧的轻微阻尼。由于噪声和阻尼极小，这是我们研究过的最简单的物理系统。双体气轨由两个不同质量的耦合谐振子组成。由于中间弹簧的压缩，这个数据集中有相当大的噪声。单摆是一个非线性振子，通常被小角度近似所掩盖。双摆是一个耦合非线性振子系统，在某些能量下表现出丰富的动力学特性（17）和混沌（18），这使得建模具有挑战性（19, 20）。此外，由于速度更高，测量噪声和阻尼误差也更大。

给定随时间的位置和速度数据，该算法收敛到了每个系统的能量定律（哈密顿方程和拉格朗日方程）。若同时给定加速度数据，它为谐振子和单摆系统生成了对应于牛顿第二定律的微分运动方程。若仅给定单摆的位置数据，算法收敛到了一个圆的方程，表明摆被限制在一个圆周上。

通过小角度近似，该算法还为单摆和双摆系统产生了一些不精确的表达式，例如用 `x` 代替 `sin(x)`，用 `1-x²` 代替 `cos(x)`。

双摆出现的一个有趣的近似定律是角动量守恒。仅给定摆在混沌状态下（高能量时）测量的数据，算法就锁定了这个定律。动量守恒方程比其他有效定律更简单，并且在重力可忽略不计的高速情况下是近似正确的，这与高能量混沌数据集的情况相符。

同样，仅给定低速同相振荡的数据，算法锁定了小角度近似和解耦的能量项。通过将混沌数据与低速同相振荡数据相结合，经过数小时的计算，算法最终收敛到了精确的能量定律。

**图3. 从物理系统的实验数据中推断出的定律摘要。** 根据提供给算法的变量类型，它会检测不同类型的定律。仅给定位置信息，算法检测位置流形；给定速度，算法检测能量定律；给定加速度，它检测运动方程和合力定律（θ，角度；ω，角速度；α，角加速度）。

---

在缺乏合适的构建模块时，算法会发展出近似解。例如，从方程构建模块集合中移除正弦和余弦运算，会导致单摆不变量被表达为 `ω² + k₁θ² - k₂θ⁴`（其中 `θ` 是摆的角度，`ω` 是角速度，`k₁` 和 `k₂` 是常数），从而利用了余弦函数的四阶泰勒级数展开。移除余弦但不移除正弦，会驱使算法收敛到 `cos(θ) = sin(θ + π/2)` 的等式或更复杂的等价形式上。

有用的科学理论既具有预测性又具有简约性。同样，有些方程可能更准确但过拟合了数据，而另一些可能更简约但过于简化。算法不是产生单一结果，而是在准确性-简约性帕累托前沿（Pareto front）上产生一小组最终候选分析表达式（图4A），这些表达式代表了随着方程复杂度和最大预测能力变化的最优解。简约性以表达式中项数的倒数来衡量，而预测准确性则通过仅用于验证的保留实验数据上的误差来衡量。

双摆的帕累托前沿（图4A）揭示了几个能够准确预测偏导数对的特别简单的方程。预测准确性是通过偏导数对判据的交叉验证来测量的。帕累托前沿倾向于包含一个“悬崖”，在某个最小复杂度处，预测能力会迅速跃升。然后，随着方程变得更复杂，预测能力仅有边际改善（图4A）。角动量守恒方程位于帕累托前沿上，尽管它并不精确。双摆的哈密顿量位于代表预测能力增幅最大的最简方程的点上。在我们所有的实验中，位于这一点的解都是一个精确的理论定律。

在最坏的情况下，收敛到定律方程的时间依赖于定律表达式本身的复杂度，呈指数关系，并大致与系统维度（变量配对的数量）成平方关系（图4B）。在一个32核的实现中，所需时间从谐振子的几分钟到双摆的30小时不等。噪声的影响也与这些因素耦合。

尽管该算法能够以数学形式呈现与物理定律相对应的方程，我们仍然面临着论证和赋予其意义的挑战。一个困难是我们无法确定定律表达式中整体常数的单位（例如，系统中包含的质量、长度等的组合）。其次，方程可能模拟了一些本身难以直接观察的东西，比如总能量。要求方程保持一致的物理单位仍然留有模糊空间。

一种更系统化解析系数的方法是分析来自相同系统但配置和参数不同的多个数据集。为了验证这种方法，我们使用了几个具有随机选择的质量和长度的虚拟双摆来生成多个合成数据集。我们将自动发现的模型的自由系数拟合到每个数据集，然后再次调用方程搜索算法，以寻找系数和参数集之间的关系。在任意定义 `k₁=1` 后，算法识别出 `k₂ = m₂L₂²/(m₁L₁² + m₂L₁²)`，`k₃ = 2m₂L₂/(m₁L₁ + m₂L₁)` 等关系，其中19.6是唯一一个在所有参数变化中单位必须是米/秒² 的绝对常数。类似的方法可以用来识别随时间缓慢变化的系数（例如，由于阻尼、蠕变或生态漂移）。

像这样的计算系统可以在建模目前挑战专家驱动研究范围的高维复杂现象中发挥作用。一个关键挑战是扩展到更高的复杂性。为实现这一点，科学家们利用从简单系统中获得的知识来解释更复杂的系统。算法也能做到这一点吗？

一种使用先验知识的方法是，用来自更简单系统方程的项来“播种”（seeding）方程搜索，即初始化算法的初始候选表达式集。例如，单摆和双谐振子的方程为支配更复杂的双摆的定律提供了线索。我们打乱了简单系统的项（例如，用双摆的速度变量交换速度符号）并随机化参数，以生成许多不精确的初始表达式。这种播种方法不会限制方程搜索，但会引导搜索偏向于重用先前定律的项。

以这种方式**引导（bootstrapping）**双摆的搜索，将搜索时间减少了近一个数量级，从30到40小时的计算时间减少到7到8小时（图4B）。基于此结果，我们推测引导对于检测隐藏在复杂性中的高阶系统定律可能至关重要。

对各种物理系统群体中子表达式频率和复杂度的统计分析显示，那些既频繁使用又复杂的项，往往在物理上更有意义，例如代表势能的三角函数项、代表动能的平方速度项，或线性力组合。这些项可能构成一个描述一系列系统的“**涌现字母表**”（emergent alphabet），这可以加速它们的建模并简化其概念理解。

**图4. 简约性与准确性和计算时间。** (A) 双摆物理定律的帕累托前沿（黑色实线曲线）以及定律方程搜索期间的采样频率（灰度）。“悬崖”处的方程对应于双摆的精确能量守恒律（图中高亮）。我们遇到的第二个动量守恒律也被高亮显示。(B) 检测不同物理系统定律所需的计算时间。计算时间随着维度、定律方程复杂度和噪声的增加而增加。一个显著的例外是引导后的双摆，其中重用来自更简单系统的项帮助将计算成本降低了近一个数量级，这暗示了一种扩展到更高复杂性的机制。

---

我们已经展示了利用计算搜索，直接从实验捕获的数据中，从零开始发现物理定律。我们使用所提出的方法，在各种合成和物理实现的系统中，无需任何关于物理、运动学或几何的先验知识，检测了非线性能量守恒律、牛顿力定律、几何不变量和系统流形。我们找到的简洁分析表达式易于人类解释，并有助于揭示观测现象背后的物理原理。这种方法在从系统生物学到宇宙学等领域存在许多应用，这些领域尽管数据丰富，但理论上仍存在空白。

这个过程会削弱未来科学家的作用吗？恰恰相反：科学家们可能会利用这样的过程，来帮助他们更迅速地聚焦于有趣的现象并解释其意义。
